출처: https://sehoonoverflow.tistory.com/6 [세훈오버플로우]

# 생활코딩 WEB2 - Home server
# 1. 수업소개
공유기를 사용하는 환경에서 웹 서버를 구동하는 방법을 알려주는 수업
공유기에 연결된 컴퓨터의 웹 서버에 불특정 다수를 접속하게 하는 일은 쉽지 않다
하지만 이 목표를 이뤄가는 과정에서 인터넷을 지배하는 핵심적인 지식과 경험을 얻을 수 있다

인터넷 위에 있는 컴퓨터와 컴퓨터가 통신하기 위해 필요한 것이 IP address
1980년대 초, IPv4 라는 인터넷 통신규칙을 만들었다
이 통신규칙에서 사용하는 ip주소는 42억개의 주소를 표현할 수 있다
0.0.0 ~255.255.255.255

web, smartphone, cloud computing, IOT
인터넷에 연결되는 컴퓨터의 수가 기하급수적으로 증가
넉넉할 줄 알았던 42억개의 주소가 동이 났음
전화번호를 모두 발급해버려서 새로운 가입자를 받을 수 없는 상황과 비슷하다

이 문제로 인류는 깊은 고민에 빠졌다
언제나 그래왔듯 여러가지 해결책을 찾아냄

첫 번째, 주소의 형식을 완전히 새롭게 바꾸는 것
새로운 인터넷 통신규칙 IPv6 는 새로운 아이피 주소규칙을 만들어냄
but, 주소를 바꾸는 건 쉽지 않음
기존에는 IPv4를 아껴 써야 함
아낄 수 있는 방법 : 공유기
공유기를 사용하면 하나의 아이피 주소를 여러 대의 컴퓨터가 나눠 쓸 수 있다
개인은 통신요금까지 절약할 수 있다
그러나 공유기에 연결되어있는 컴퓨터에 서버를 설치해서 운영하는 것은 쉽지 않다
이를 위해서는 network address translation
public vs private ip address
port forwarding
dynamic vs static IP address
dynamic DNS 과 같은 개념들을 알아야 한다

우리는 공유기에 연결된 컴퓨터를 웹 서버로 이용하는 방법을 알아볼 것이다
클라이언트로만 사용되던 우리의 컴퓨터를 서버로 사용된다는 것은
소비자로만 살아오던 사람이 생산자가 되는 것만큼이나 혁명적인 사건이다
컴퓨터가 가진 무한한 잠재력을 흔들어 깨워보자


# WEB2-Home server-2. 공유기
Router == 공유기

IP address internet protocal address
인터넷을 사용하기 위해선 컴퓨터가 아이피주소를 가지고 있어야한다
그래야 다른 컴퓨터와 통신이 가능하다

두 대의 컴퓨터가 인터넷으로 통신한다 했을 때,
하나의 컴퓨터는 서버, 하나의 컴퓨터는 클라이언트가 된다

공유기
하나의 WAN - 하나의 케이블과 연결
-> 통신사로부터 받은 IP 주소가 공유기의 것이 된다
여러개의 LAN
-> 각각의 인터넷 기기들과 연결 가능

공유기를 중심으로 노트북, PC, 스마트폰이 같은 네트워크에 묶인다
-> 지역네트워크 == LAN == LOCAL AREA NETWORK
공유기 : 인터넷이라는 광역 네트워크에 소속
-> 광역네트워크 == WAN == WIDE AREA NETWORK

LAN, WAN 두 개의 네트워크에 사이에 있는 일종의 중개자, 교환원 : 공유기(라우터)

공유기의 케이블이나 무선으로 연결된 인터넷 기기들은 자동으로 아이피를 부여받는다
이 네트워크 안에 소속되어 있는 기기들뿐만 아니라
공유기도 네트워크의 일부이기 때문에 공유기에도 IP가 부여된다
ex)
WAN public IP ADDRESS : 59.6.66.238
공유기 : 192.168.0.1 == 특수한 역할이라 따로 이름이 있다, "Gateway address or Router address"
스마트폰 : 192.168.0.2
컴퓨터 : 192.168.0.3
노트북 : 192.168.0.4

WAN 안에서 이 공유기로 접속할 수 있게 하는 IP : public IP address 누구나 접속 가능, 공용 IP
나머지 스마트폰, 컴퓨터, 노트북의 IP는 회사의 내선번호와 같다
지역 네트워크 안에서만 쓸 수 있는 IP ADDRESS == private IP address, 사설 IP

ipv4 시대의 주소 체계는 총 42억개의 주소가 있다
사설 ip 주소는 192.198.0.0 ~ 192.168.255.255 여기에만 속하는 걸로 정해져있다

# 3.NAT
Network Address Translation
이 기술 덕분에 사설 ip 사용하는 각각의 컴퓨터들이 외부 인터넷에 접속할 수 있게 된다

if, 내 노트북으로 위키피디아에 접속한다 했을 때,,, 네트워크 내부적으로 어떤 일이 일어날까
노트북의 private IP address가 위키피디아에 요청을 함
192.168.0.4가 gateway address 머신에게 신호를 보낸다 - 공유기가 받음
공유기가 보니까, 이 요청이 내부 네트워크 안에 있는 요청이 아님
위키피디아는 내부 네트워크 안에 없으니까
이 공유기는 요청을 WAN을 통해 외부로 보낸다
보내기 전에 두 가지 일을 한다

1) 위키피디아로 가는 이 요청이 192.168.0.4 아이피를 가진 컴퓨터의 요청이다 라는 것을
공유기 안에다가 마법같은 방법으로 기록을 해 둔다

2) 요청한 컴퓨터는 사실 192.1680.4를 쓰는데, 이 주소는 외부에서 접속을 못하는 주소
그래서 공유기의 NAT라는 기술이 요청한 데이터를 변경한다
어떻게? 192.168.0.4라고 되어 있던 부분을 59.6.66.238으로 변경한 다음에
그 변경된 데이터를 위키피다에 쏴 준다

첫번째는 192.168.0.4가 요청함을 기록
두번째는 요청하는 데이터의 내용을 192.168.0.4를 59.6.66.238로 바꾼다
그러면 위키피디아가 그 요청에 응답을 한다
위키피디아는 59.6.66.238에게 응답을 함
공유기는 응답받은 정보를 보고, 그 정보가 192.168.0.4가 요청했었던 정보라는 사실을
파악한 다음에 (기록이 되어 있으니까) 그것에 응답을 해 준다

사설 IP를 쓰고 있는 노트북이 사설 바깥인 PUBLIC IP 세계에 접속을 할 수 있게 되고
그 때 사용되는 기술이 NETWORK ADDRESS TRANSLATION이다

여기까지 우리는 사설 IP를 사용하는 컴퓨터를 클라이언트로 사용했을 경우
NAT가 동작하는 방법을 살펴본 것이다

그렇다면 이제는 클라이언트가 아닌 홈서버로 이용할 때는 어떻게 처리되는지를 살펴봐야 한다

# 4. IP 주소 알아내기



# 생활코딩 HomeServer -7. Dynamic & Static IP address

Dynamic VS Static
IP Address





